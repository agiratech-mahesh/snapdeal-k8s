node('master'){
stage('docker') {
   sh" docker login -u maheshagiratech -p dckr_pat_QiQRDlDTHhDMibM4mnWGmhv7idI "
}
stage('git ') {
   sh "git config --global  user.name agiratech-mahesh"
   sh "git config --global  user.email mahesh.m@agiratech.com"
   sh "rm -rf snapdeal-k8s && git clone https://github.com/agiratech-mahesh/snapdeal-k8s.git"
}
stage('build') {
   sh " cd /home/ubuntu/workspace/snapdeal-k8s "
   sh "docker build -t maheshagiratech/k8s ."
   sh "docker push maheshagiratech/k8s"
 }
stage('k8s deploy') {
    sh "cd /home/ubuntu/workspace/k8 "
    sh " kubectl create -f jenkins-deployment.yml "
    sh " kubectl create -f jenkins-service.yml "
}
}
